---
title: ã€ŒCodeforces Roundã€#811 (Div 3)
tags:
  - è´ªå¿ƒ
  - DP
categories:
  - é¢˜è§£
  - æ¯”èµ›
pubDate: 2022-08-04
description: 'ä¸ªäººé¢˜è§£'
---

**CF1714**.

æœ€è¿‘æ‘¸å¾—æœ‰ç‚¹å‰å®³ï¼Œä¸»è¦æ˜¯è¢«è‡ªå·±èœåˆ°äº†ï¼Œå¿ƒæ€æœ‰ç‚¹å·®â€¦â€¦

è€å¹´äººä¹Ÿå°±çœ‹çœ‹ Div 3 äº†ã€‚



## A. Everyone Loves to Sleep

è½¬åŒ–æˆåˆ†é’Ÿä¹±æå³å¯ã€‚

```cpp
#include<bits/stdc++.h>
using namespace std;
#define int long long
int t, n, H, M, D, ans, h[15], m[15], d[15];
int read() {
    int a=0, f=1; char c=getchar();
    while(!isdigit(c)) {
        if(c=='-') f=-1;
        c=getchar();
    }
    while(isdigit(c)) a=a*10+c-'0', c=getchar();
    return a*f;
}
void solve() {
    n=read(), H=read(), M=read();
    D=H*60+M;
    ans=1<<30;
    for(int i=1;i<=n;++i) {
        h[i]=read(), m[i]=read();
        d[i]=h[i]*60+m[i];
        if(d[i]<D) d[i]+=24*60;
    }
    for(int i=1;i<=n;++i) ans=min(ans,d[i]-D);
    printf("%lld %lld\n",ans/60,ans%60);
}
signed main() {
    t=read();
    while(t--) solve();
}
```

## B. Remove Prefix

ä»åå¾€å‰å¯»æ‰¾ç¬¬ä¸€ä¸ªé‡å¤æ•°å­—å‡ºç°çš„ä½ç½®å³å¯ã€‚

```cpp
#include<bits/stdc++.h>
using namespace std;
#define int long long
const int N=2e5+5;
int t, n, ans, a[N];
map<int,int> p;
int read() {
    int a=0, f=1; char c=getchar();
    while(!isdigit(c)) {
        if(c=='-') f=-1;
        c=getchar();
    }
    while(isdigit(c)) a=a*10+c-'0', c=getchar();
    return a*f;
}
void solve() {
    n=read();
    p.clear(), ans=0;
    for(int i=1;i<=n;++i) a[i]=read();
    for(int i=n;i;--i) {
        ++p[a[i]];
        if(p[a[i]]>1) { ans=i; break; }
    }
    printf("%lld\n",ans);
}
signed main() {
    t=read();
    while(t--) solve();
}
```



## C. Minimum Varied Number

æ³¨æ„åˆ° $t \in [1,45]$ï¼Œè¯´æ˜ç­”æ¡ˆæœ€å¤§å°±æ˜¯ $123456789$ï¼Œé‚£ä¹ˆè¦æ±‚æ•°å­—æœ€å°åªè¦è´ªå¿ƒä»åå¾€å‰ä¾æ¬¡æ”¾ç½®å³å¯ã€‚

```cpp
#include<bits/stdc++.h>
using namespace std;
#define int long long
int t, n, ans[100];
int read() {
    int a=0, f=1; char c=getchar();
    while(!isdigit(c)) {
        if(c=='-') f=-1;
        c=getchar();
    }
    while(isdigit(c)) a=a*10+c-'0', c=getchar();
    return a*f;
}
void solve() {
    n=read();
    memset(ans,0,sizeof(ans));
    for(int i=9;i;--i) if(n>i) {
        n-=i; ans[i]=i;
    } else { ans[i]=n; break; }
    for(int i=1;i<=10;++i) if(ans[i]) printf("%lld",ans[i]);
    puts("");
}
signed main() {
    t=read();
    while(t--) solve();
}
```

## D. Color with Occurrences

æ³¨æ„åˆ°é¢œè‰²æ˜¯å¯ä»¥è¦†ç›–çš„ï¼Œæ‰€ä»¥ä¹Ÿå¯ä»¥ç†è§£ä¸ºâ€œæ— åæ•ˆæ€§å§â€ã€‚

é‚£ä¹ˆè®¾ $f(i)$ ä¸ºå°† $[1,i]$ æŸ“è‰²ç”¨çš„æœ€å°æ¬¡æ•°ï¼Œé‚£ä¹ˆå¯¹äºä¸€ä¸ªå­—ç¬¦ä¸² $j$
$$
f(i) = \min_{k \in [i-l_j,i-1]}{ \{ f_k + 1} \}
$$
å…¶ä¸­ $l_j$ æ˜¯ $j$ çš„é•¿åº¦ï¼Œä¸”å¿…é¡»æ»¡è¶³ $i \ge l_j$ ä¸” $t[i-l_j+1,i] = a_j$ã€‚

ä¸ºå•¥ä¸æŠŠ $j$ åŠ å…¥çŠ¶æ€å‘¢ï¼Ÿå¤æ‚åº¦æ˜¯ä¸ä¼šå˜åŒ–çš„ï¼Œæ˜¯å†—ä½™ä¿¡æ¯ã€‚

è€ƒè™‘è¾“å‡ºæ–¹æ¡ˆã€‚ä¸€å¼€å§‹æˆ‘ç«Ÿç„¶ç”¨äº†ä¸€ä¸ª SB äºŒç»´æ•°ç»„ä¹±æï¼Œç»“æœè¿˜çœŸçš„è¿‡äº†æ ·ä¾‹å’Œç¬¬ä¸€ä¸ªç‚¹ï¼Œä½†æ˜¯ä¼š WA #2ã€‚ä»”ç»†ä¸€æƒ³ï¼Œè¾“å‡ºæ–¹æ¡ˆå®é™…ä¸Šæ˜¯æŠŠ DP çš„è¿‡ç¨‹é‡ç°ä¸€éï¼Œé‚£ä¹ˆè¾“å‡ºæ–¹æ¡ˆæ—¶éœ€è¦çš„ä¿¡æ¯åº”å½“ä¸çŠ¶æ€ç›¸åŒï¼Œä½†æ˜¯ç”±äºä¸ä»…è¦è¾“å‡ºå†³ç­–ç‚¹ï¼Œè¿˜è¦è¾“å‡ºæ‰€ç”¨çš„å­—ç¬¦ä¸²ç¼–å·ï¼Œæ‰€ä»¥è¦ç”¨ä¸¤ä¸ªæ•°ç»„ã€‚~~æˆ‘ä¸€å¼€å§‹å°±æ˜¯æŠŠè¿™ä¸¤ä¸ªåˆä¸€äº†~~ã€‚

è®¾ $g_1(i)$ è¡¨ç¤ºå†³ç­–ç‚¹ï¼Œ$g_2(i)$ è¡¨ç¤ºå°† $i$ æŸ“è‰²ç”¨çš„å­—ç¬¦ä¸²ç¼–å·ã€‚

```cpp
#include<bits/stdc++.h>
using namespace std;
#define int long long
const int N=105, M=15;
int t, n, m, f[N], l[M], g1[N], g2[N];
string s, a[M];
int read() {
    int a=0, f=1; char c=getchar();
    while(!isdigit(c)) {
        if(c=='-') f=-1;
        c=getchar();
    }
    while(isdigit(c)) a=a*10+c-'0', c=getchar();
    return a*f;
}
void print(int i) {
    // iè¡¨ç¤ºæŸ“è‰²çš„ä½ç½®
    if(!i) return;
    print(g1[i]);
    // içš„å†³ç­–ç‚¹ï¼Œä¹Ÿå°±æ˜¯ä¸Šä¸€ä¸ªæŸ“è‰²çš„ä½ç½®
    printf("%lld %lld\n",g2[i],i-l[g2[i]]+1);
    // ç”¨çš„å­—ç¬¦ä¸²ç¼–å·çš„æŸ“è‰²çš„ä½ç½®
}
void solve() {
    memset(f,0x3f,sizeof(f));
    memset(l,0,sizeof(l));
    memset(g1,0,sizeof(g1));
    memset(g2,0,sizeof(g2));
    cin>>s; n=read();
    m=s.length(), s=" "+s;
    for(int i=1;i<=n;++i) cin>>a[i], l[i]=a[i].length();
    f[0]=0;
    for(int i=1;i<=m;++i) for(int j=1;j<=n;++j) if(i>=l[j]) {
        if(s.substr(i-l[j]+1,l[j])==a[j]) {
            int p=m+1;
            for(int k=i-l[j];k<i;++k) if(f[p]>f[k]) p=k;
            if(f[i]>f[p]+1) f[i]=f[p]+1, g1[i]=p, g2[i]=j;
        }
    }
    printf("%lld\n",f[m]<=m? f[m]:-1);
    // ä¸éš¾å‘ç°åªè¦èƒ½å¤Ÿå…¨éƒ¨æŸ“è‰²ï¼Œæ¬¡æ•°ç»ä¸ä¼šè¶…è¿‡m
    if(f[m]<=m) print(m);
}
signed main() {
    t=read();
    while(t--) solve();
}
```

## E. Add Modulo 10

æ³¨æ„åˆ°å¦‚æœæŸä¸ªæ•°æ¨¡ $10$ ä¸º $0$ï¼Œé‚£ä¹ˆå®ƒå°±ä¸ä¼šå˜åŒ–ï¼Œå¦‚æœæ¨¡ $10$ ä¸º $5$ï¼Œé‚£ä¹ˆå®ƒåªä¼šæ”¹å˜ä¸€æ¬¡ã€‚

å®ƒä»¬å¯ä»¥å½’ä¸ºä¸€ç±»â€”â€”å› ä¸ºå®ƒä»¬çš„ç»ˆæ€éƒ½èƒ½è®¡ç®—å‡ºæ¥ï¼Œå§‘ä¸”ç§°ä¹‹ä¸º $\alpha$ ç±»ï¼Œå…¶ä»–ç§°ä¹‹ä¸º $\beta$ ç±»ã€‚å¦‚æœæ—¢æœ‰ $\alpha$ ç±»åˆæœ‰ $\beta$ ç±»ï¼Œé‚£ä¹ˆç»å¯¹ä¸å¯èƒ½å…¨éƒ¨ç›¸ç­‰ã€‚

å¦åˆ™å¦‚æœåªæœ‰ $\alpha$ ç±»ï¼Œé‚£ä¹ˆç›´æ¥ç®—å‡ºæ¥åˆ¤æ–­æ˜¯å¦å…¨éƒ¨ç›¸ç­‰å³å¯ã€‚

æœªç»ç‰¹æ®Šå£°æ˜ï¼Œä¸‹é¢çš„æ•°éƒ½æ˜¯æ¨¡ $10$ ä¹‹åçš„ç»“æœã€‚

è€ƒè™‘è¿™æ ·ä¸€æ¡è·¯å¾„ï¼Œ$1 \rightarrow 2 \rightarrow 4 \rightarrow 8$ã€‚

$3 \rightarrow 6 \rightarrow 2$ï¼Œ$7 \rightarrow 4$ï¼Œ$9 \rightarrow 8$ï¼Œè¿™äº›æ“ä½œéƒ½èƒ½è®©æœ¬ä¸å±äºè¿™æ¡è·¯å¾„çš„æ•°å­—åŠ å…¥è·¯å¾„ï¼Œä¸”æœ€ç»ˆéƒ½ä¼šè¾¾åˆ° $8$ï¼Œé‚£ä¹ˆå¯ä»¥çŸ¥é“ä¸€å®šèƒ½åšåˆ°è®©æ‰€æœ‰çš„æ•°æ¨¡  $10$ ç›¸åŒï¼Œä½†æ˜¯ä¸€å®šèƒ½å…¨éƒ¨ç›¸ç­‰å—ï¼Ÿ

æ³¨æ„åˆ° $8$ å’Œ $28$ï¼Œå°† $8$ è¿›è¡Œå˜æˆ $28$ éœ€è¦ $4$ æ¬¡æ“ä½œï¼Œä½†æ˜¯æ ¹æœ¬æ— æ³•è®© $28$ å˜æˆ $38$ã€‚è¿™æ˜¯å› ä¸ºè·¯å¾„ä¸­ $8$ å˜æˆ $8$ è¦è¿›ä½ä¸¤æ¬¡ï¼Œæ‰€ä»¥åªæœ‰ä¸ªä½æ˜¯ $8$ çš„ä¸¤ä¸ªæ•°çš„å·®æ˜¯ $10$ çš„å¶æ•°å€æ‰èƒ½æ»¡è¶³æ¡ä»¶ã€‚

```cpp
#include<bits/stdc++.h>
using namespace std;
#define int long long
const int N=2e5+5;
int t, n, a[N], f1, f2;
int read() {
    int a=0, f=1; char c=getchar();
    while(!isdigit(c)) {
        if(c=='-') f=-1;
        c=getchar();
    }
    while(isdigit(c)) a=a*10+c-'0', c=getchar();
    return a*f;
}
bool pd(int a,int b) {
    int d=abs(a-b);
    return (d/10)%2;
}
void solve() {
    n=read();
    f1=f2=0;
    for(int i=1;i<=n;++i) {
        a[i]=read();
        if(a[i]%10==0||a[i]%10==5) f1=1;
        else f2=1; 
    }
    if(f1&&f2) { puts("No"); return; }
    else if(f1) {
        for(int i=1;i<=n;++i) {
            if(a[i]%10==5) a[i]+=5;
            if(i>1&&a[i]!=a[i-1]) { puts("No"); return; }
        }
        puts("Yes"); return;
    } else {
        for(int i=1;i<=n;++i) {
            if(a[i]%10==1||a[i]%10==2||a[i]%10==4) {
                a[i]-=a[i]%10, a[i]+=8;
            }
            else if(a[i]%10==3||a[i]%10==6||a[i]%10==7||a[i]%10==9) {
                a[i]-=a[i]%10, a[i]+=18;
            }
            if(i>1&&pd(a[i],a[i-1])) { puts("No"); return; }
        }
        puts("Yes"); return;
    }
}
signed main() {
    t=read();
    while(t--) solve();
}
```

## F. Build a Tree and That Is It

æ²¡çœ‹ï¼Œä¸ä¼šã€‚ğŸ˜¢

## G. Path Prefixes

ç»´æŠ¤æ ‘ä¸Šå‰ç¼€å’Œï¼Œè®°ä¸º $sa$ï¼Œ$sb$ã€‚

åœ¨ä¸€æ¡è·¯å¾„ä¸Šï¼Œæ‰¾åˆ°ç¬¬ä¸€ä¸ªä¸¥æ ¼å¤§äº $sa_x$ çš„ $sb_y$ï¼Œé‚£ä¹ˆ $sa_x$ ä¸€å®šä¸¥æ ¼å¤§äºä¹‹å‰çš„æ¯ä¸€ä¸ª $sb$ï¼Œäºæ˜¯ $y-1$ å³ä¸ºç­”æ¡ˆã€‚$x$ ä¸ $y$ éƒ½æ˜¯è·¯å¾„ä¸ŠèŠ‚ç‚¹çš„ç¼–å·ã€‚ç”±äº $sb$ æ˜¾ç„¶æ˜¯å•è°ƒå¢çš„ï¼Œå¯ä»¥äºŒåˆ†æŸ¥æ‰¾ã€‚

åœ¨æ›´æ–°æ›´æ–°å®Œ $x$ çš„æ‰€æœ‰å­èŠ‚ç‚¹ä¹‹åè¿˜åŸ $sa_x$ï¼Œ$sb_x$ å³å¯ã€‚

```cpp
#include<bits/stdc++.h>
using namespace std;
#define int long long
const int N=2e5+5;
int t, n,  sa, sb, a[N], b[N], ans[N];
int tot, h[N], to[2*N], nxt[2*N];
vector<int> ssb;
int read() {
    int a=0, f=1; char c=getchar();
    while(!isdigit(c)) {
        if(c=='-') f=-1;
        c=getchar();
    }
    while(isdigit(c)) a=a*10+c-'0', c=getchar();
    return a*f;
}
void add(int x,int y) {
    to[++tot]=y, nxt[tot]=h[x], h[x]=tot;
}
void dfs(int x,int fa) {
    sa+=a[x], sb+=b[x];
    ssb.push_back(sb);
    ans[x]=upper_bound(ssb.begin(),ssb.end(),sa)-ssb.begin()-1;
    for(int i=h[x];i;i=nxt[i]) {
        int y=to[i];
        if(y!=fa) dfs(y,x);
    }
    sa-=a[x], sb-=b[x];
    ssb.pop_back();
}
void solve() {
    n=read();
    tot=sa=sb=0;
    ssb.clear();
    for(int i=1;i<=n;++i) h[i]=0;
    for(int i=2;i<=n;++i) {
        int p=read();
        a[i]=read(), b[i]=read();
        add(p,i), add(i,p);
    }
    dfs(1,0);
    for(int i=2;i<=n;++i) printf("%lld%c",ans[i]," \n"[i==n]);
}
signed main() {
    t=read();
    while(t--) solve();
}
```
