---
title: CF900D Unusual Sequences 题解
pubDate: 2023-11-12
tags:
  - 数论
  - DP
  - 计数
  - 容斥原理
  - 莫比乌斯反演
categories: 题解
description: 'Solution'
---

## Solution

如果 $x \nmid y$，那么无解。

令 $m = y/x$，问题转化为求有多少个序列，满足 $\gcd=1$，和为 $m$。

设 $f(n)$ 为和为 $n$ 的序列数量，$g(n)$ 为和为 $n$ 且 $\gcd=1$ 的序列数量，有

$$
f(n) = \sum_{d \mid n} g \Big( \frac{n}{d}\Big) = 2^{n-1}
$$

容斥掉就是

$$
g(n) = f(n) - \sum_{d \mid n, d \neq 1} g\Big(\frac{n}{d}\Big)
$$

反演掉就是

$$
g(n) = \sum_{d \mid n} \mu(d) g\Big(\frac{n}{d}\Big)
$$

答案是 $g(m)$。

代码中求的是后者。枚举约数然后 $O(\sqrt{m})$ 求 $\mu$，复杂度 $O(m)$，常数较小。

```cpp
#include<bits/stdc++.h>
using namespace std;
#define int long long
#define uint unsigned long long
#define PII pair<int,int>
#define MP make_pair
#define fi first
#define se second
#define pb push_back
#define eb emplace_back
#define SET(a,b) memset(a,b,sizeof(a))
#define CPY(a,b) memcpy(a,b,sizeof(b))
#define rep(i,j,k) for(int i=(j);i<=(k);++i)
#define per(i,j,k) for(int i=(j);i>=(k);--i)
int read() {
    int a=0, f=1; char c=getchar();
    while(!isdigit(c)) {
        if(c=='-') f=-1;
        c=getchar();
    }
    while(isdigit(c)) a=a*10+c-'0', c=getchar();
    return a*f;
}
const int mod=1e9+7;
int x, y, ans;
int fp(int a,int b) {
    int c=1;
    for(;b;a=a*a%mod,b>>=1) if(b&1) c=c*a%mod;
    return c;
}
int mu(int x) {
    int res=1;
    if(x==1) return res;
    for(int i=2;i*i<=x;++i) if(x%i==0) {
        x/=i;
        if(x%i==0) return 0;
        res=-res;
    }
    res=-res;
    return (res+mod)%mod;
}
signed main() {
    x=read(), y=read();
    if(y%x) {
        puts("0");
        return 0;
    }
    y/=x;
//    printf("mu(2)=%lld\n",mu(2));
    for(int i=1;i*i<=y;++i) if(y%i==0) {
        (ans+=mu(i)*fp(2,y/i-1)%mod)%=mod;
        if(i*i!=y) (ans+=mu(y/i)*fp(2,i-1)%mod)%=mod;
    }
    printf("%lld\n",ans);
    return 0;
}

```
